window.MapifyEmbed||(window.MapifyEmbed={baseURL:null,usePlainPermalinks:!1,setBaseURL:function(e){if(MapifyEmbed.baseURL&&MapifyEmbed.baseURL!=e)throw new Error("Cannot reassign the base URL for MapifyEmbed.");MapifyEmbed.baseURL=e},buildTargetURL:function(e,t){let a,n=MapifyEmbed.baseURL;return e.startsWith("/")||(e="/"+e),a=t&&t instanceof URLSearchParams?new URLSearchParams(t.toString()):new URLSearchParams(t),MapifyEmbed.usePlainPermalinks?a.append("rest_route",e):n=n+"/wp-json"+e,a&&(n=n+"?"+a.toString()),n},patchPopupLinks:function(e){let t=e.querySelectorAll("a");for(let e=0;e<t.length;e++){let a=t[e],n=a.getAttribute("href");n&&!n.startsWith("http")&&"#"!=n&&(n.startsWith("/")||(n="/"+n),a.setAttribute("href",MapifyEmbed.baseURL+n))}},patchMapifyPopup:function(){const e=window.Mapify||jQuery.MapifyObject;if(MapifyEmbed.__patchedOpenPopup===e.openPopup)return;const t=e.openPopup;MapifyEmbed.__patchedOpenPopup=t;const a=function(e,a){let n=new URL(e),i=n.searchParams,p=e;if(MapifyEmbed.usePlainPermalinks&&"/"==n.pathname&&i.has("map-location")){let e=i.get("map-location");i.delete("map-location"),p=MapifyEmbed.buildTargetURL("/get-map/v1/location/"+e,i)}else if(!MapifyEmbed.usePlainPermalinks&&n.pathname.startsWith("/map-location/")){let e=n.pathname.replace("/map-location/","");p=MapifyEmbed.buildTargetURL("/get-map/v1/location/"+e,i)}return t(p,(function(){let e=document.querySelectorAll(".mpf-p-popup-holder");for(let t=0;t<e.length;t++){let a=e[t];MapifyEmbed.patchPopupLinks(a)}"undefined"!=a&&a&&a()}))};e.openPopup=a,MapifyEmbed.__patchedOpenPopup=a},embedFromScript:function(e){let t=e.getAttribute("mapid"),a=e.getAttribute("mapheight"),n=e.getAttribute("mapwidth"),i=e.getAttribute("render-target");t&&MapifyEmbed.embedMap(t,a,n,i)},embedMap:function(e,t,a,n){let i={};t&&(i.height=t),a&&(i.width=a);let p=MapifyEmbed.buildTargetURL("/get-map/v1/data/"+e,i);fetch(p).then((e=>e.json())).then((e=>{MapifyEmbed.loadMap(n,e.mapMarkup,e.mapSetup,e.customCss,e.customJs)}))},embedMapDirectly:function(e,t,a,n,i){let p=document.currentScript.getAttribute("render-target");MapifyEmbed.loadMap(p,e,t,n,i)},loadMap:function(e,t,a,n,i){let p;if("self"==e){let e=document.currentScript;p=document.createElement("DIV"),p.id="mapify-embed",e.parentNode.insertBefore(p,e.nextSibling)}else p=document.querySelector(e||"#mapify-embed");if(p){p.innerHTML="";let e=document.createElement("DIV");e.classList.add("map-dropin-container"),p.appendChild(e);let r=document.createElement("DIV");if(r.classList.add("markup-container"),r.innerHTML=t,n){let e=document.createElement("STYLE");e.innerHTML=n,r.appendChild(e)}e.appendChild(r);let d=document.createElement("DIV");d.classList.add("setup-container");let l=document.createElement("DIV");l.classList.add("static-container"),l.innerHTML=a;let o=document.createElement("DIV");o.classList.add("dynamic-container"),d.appendChild(l),d.appendChild(o);let c=l.querySelectorAll("script"),m=[],s=[];for(let e=0;e<c.length;e++){let t=c[e];t.src?s.push(new Promise(((e,a)=>{let n=document.createElement("SCRIPT");n.type=t.type,n.src=t.src,n.id=t.id,n.async=!1,n.defer=!1,n.onload=e,n.onerror=a,t.remove(),o.appendChild(n)}))):m.push(t)}e.appendChild(d),Promise.all(s).then((()=>{if(MapifyEmbed.patchMapifyPopup(),i){let e=document.createElement("SCRIPT");e.type="text/javascript",e.innerHTML=i,e.id="mapify-embed-custom-js",o.appendChild(e)}for(let e=0;e<m.length;e++){let t=m[e],a=document.createElement("SCRIPT");a.type=t.type,a.innerHTML=t.innerHTML,a.id=t.id,t.remove(),o.appendChild(a)}}))}}}),MapifyEmbed.baseURL||function(){let e=document.currentScript.getAttribute("baseurl");if(!e){let t=document.currentScript.src.split("/");e=t[0]+"//"+t[2]}MapifyEmbed.setBaseURL(e);let t=document.currentScript.getAttribute("use-plain-permalinks");t&&"false"!=t&&(MapifyEmbed.usePlainPermalinks=!0)}(),MapifyEmbed.embedFromScript(document.currentScript);